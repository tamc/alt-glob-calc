# coding: utf-8
# Test for model
require 'minitest/autorun'
require_relative 'model'

class TestModel < Minitest::Unit::TestCase
  def test_run
    workbook = Model.new

    workbook.input_choices = [[1.0], [0.0], [1.1], [1.0], [2.3], [2.0], [1.0], [1.0], [1.0], [1.0], [2.0], [1.0], [1.0], [1.0], [1.0], [1.0], [0.0], [3.0], [4.0], [4.0], [1.0], [2.0], [4.0], [0.0], [0.0], [4.0], [4.0], [1.0], [4.0], [4.0], [4.0], [0.0], [3.0], [1.0], [4.0], [4.0], [0.0], [4.0], [2.0], [0.0], [3.0], [3.0], [0.0], [4.0], [4.0], [4.0], [0.0], [4.0], [2.0], [0.0], [1.0], [1.0], [1.0]]

    assert_equal(workbook.input_choices, [[1.0], [0.0], [1.1], [1.0], [2.3], [2.0], [1.0], [1.0], [1.0], [1.0], [2.0], [1.0], [1.0], [1.0], [1.0], [1.0], [0.0], [3.0], [4.0], [4.0], [1.0], [2.0], [4.0], [0.0], [0.0], [4.0], [4.0], [1.0], [4.0], [4.0], [4.0], [0.0], [3.0], [1.0], [4.0], [4.0], [0.0], [4.0], [2.0], [0.0], [3.0], [3.0], [0.0], [4.0], [4.0], [4.0], [0.0], [4.0], [2.0], [0.0], [1.0], [1.0], [1.0]])
    assert_equal(workbook.input_descriptions, [["No new nuclear power installed; estimated closure of final plant in 2035", "~13 3GW power stations delivering ~280 TWh/yr", "~30 3GW power stations delivering ~630 TWh/yr", "~50 3GW power stations delivering ~1030 TWh/yr"], [nil, nil, nil, nil], ["Demonstration plants only; no roll-out of CCS", "~260 TWh/yr from 25-40 CCS power stations; comparable to current gas & coal generation", "~370 TWh/yr from 35-60 CCS power stations; comparable to total current demand", "~550 TWh/yr  from 50-90 CCS power stations; build rate of gas plants in the 1990s"], ["100% coal/biomass, 0% gas/biogas CCS after demonstration plants", "66% coal/biomass, 33% gas/biogas CCS after demonstration plants", "33% coal/biomass, 66% gas/biogas CCS after demonstration plants", "0% coal/biomas, 100% gas/biogas CCS after demonstration plants"], ["~1,400 turbines in 2025, reducing to zero as decommissioned sites are not replanted", "~10,000 turbines in 2050, delivering ~237 TWh/yr", "~17,000 turbines in 2050, delivering ~395 TWh/yr", "~40,000 turbines in 2050, delivering ~929 TWh/yr"], ["~4,400 turbines in 2025, reducing to zero as decommissioned sites are not replanted", "~8,000 turbines in 2050, delivering ~50 TWh/yr. ", "~13,000 turbines in 2050, delivering ~80 TWh/yr", "~20,000 turbines in 2050, delivering ~130 TWh/yr"], ["None in 2050", "~300km of wave farms", "~600km of wave farms", "~900km of wave farms"], ["None in 2050", "1,000 tidal stream turbines", "4,700 tidal stream turbines", "10,600 tidal stream turbines"], ["None in  2050", "3 small tidal range schemes", "4 tidal range schemes", "8 tidal range schemes"], ["Only plants built and under construction (0.6GW)", "8GW power stations by 2050 delivering 62TWh/yr", "12GW power stations by 2050 delivering 100TWh/yr", "Over 20GW installed capacity by 2050 delivering 180TWh/yr"], ["No significant solar PV capacity is installed", "4m2 of photovoltaic panels per person in 2050, supplying ~60 TWh/yr of electricity", " 5.4m2 of photovoltaic panels per person in 2050, supplying ~80 TWh/yr", "9.5m2 of photovoltaic panels per person – all suitable roof and facade space used"], ["As today, a negligible proportion of buildings have solar thermal in 2050", "~30% of suitable buildings get ~30% of their hot water from solar thermal", "All suitable buildings get ~30% of their hot water from solar thermal", "All suitable buildings get ~60% of their hot water from solar thermal"], ["No deployment of geothermal electricity generation", "Supply of geothermal electricity grows slowly to 7 TWh/yr in 2035 and is sustained", "Supply grows quickly reaching 21 TWh/yr by 2030 and is sustained", "Supply grows rapidly reaching 35 TWh/yr by 2030 and is sustained"], ["Supply of electricity is maintained at current levels of 5 TWh/yr", "Supply grows slowly, reaching 7 TWh/yr by 2050", "Supply grows more quickly, reaching 8 TWh/yr by 2030 and is sustained", "Supply grows rapidly reaching 13 TWh/yr by 2035 and is sustained"], ["As today, no discernable supply of electricity from micro-wind turbines", "Supply increases to 1.3 TWh/yr by 2020 and is sustained", "Installed in all ~450,000 suitable domestic properties; supplies 3.5 TWh/year from 2020", "Installed in all suitable domestic and non-domestic sties; 8.9 TWh/year from 2020"], ["No electricity imports, other than for balancing", "30 TWh/yr of electricity imported from Southern Europe", "70 TWh/yr imported from UK 10% share of international desert solar project ", "140 TWh/yr imported from UK 20% share of international desert solar project"], [nil, nil, nil, nil], ["Energy crops and food production similar to today", "5% of land used for energy crops", "10% of land used for energy crops", "17% of land used for energy crops"], ["Livestock numbers increase by 10%", "Livestock numbers same as today", "Livestock numbers decrease by 10%", "Livestock numbers decrease by 20%"], ["Quantity of waste increases 50%; Small increase in rates of recycling and EFW.", "Quantity of waste increases 20%; Increase in rates of recycling and EFW.", "Quantity of waste increases 33%; Significant increase in rates of recycling and EFW through innovation.", "Quantity of waste decreases 20%; Significant increase in rate of recycling."], ["No development of macro-algae cultivation", "Area same as half of natural reserve used, delivering ~4 TWh/yr", "Area same as all of natural reserve used, delivering ~9 TWh/yr", "Area same as four times natural reserve used, delivering ~46 TWh/yr"], ["Biomass converted to a mixture of solid, liquid and gas biofuels", "Biomass mainly converted to solid biofuel", "Biomass mainly converted to liquid biofuel", "Biomass mainly converted to biogas fuel"], ["Imported biofuel declines from ~ 4 TWh/yr currently to zero", "Up to 70 TWh/yr of imported bioenergy in 2050", "Up to 140 TWh/yr of imported bioenergy in 2050", "Up to 280 TWh/yr of imported bioenergy in 2050"], [nil, nil, nil, nil], [nil, nil, nil, nil], ["In 2050, individuals travel 9% further than today. No noticeable modal shift.", "Individuals travel 7% further than today, cars and vans are 80% of 2050 passenger mileage", "Individuals travel 7% further than today; cars and vans 74% of 2050 passenger mileage", "In 2050, individuals travel the same distance as today. Signficant shift to public transport."], ["By 2050, 20% plug in hybrid electric cars; 2.5% zero emission cars.", "By 2050, 54% plug-in hybrid vehicles; 11%  zero emission vehicles, all buses hybrids.", "By 2050, 32% plug-in hybrid vehicles; 48% zero emission vehicles; 22% buses electric.", "By 2050 100%  zero emission vehicles; all passenger trains electrified; 50% buses electric"], ["100% of zero emission cars use batteries by 2050", "Among zero emission cars, 80% use batteries and 20% use fuel cells by 2050", "Among zero emission cars, 20% use batteries and 80% use fuel cells by 2050", "100% of zero emission cars use fuel cells by 2050"], ["Road haulage makes up 73% of distance, using conventional engines. Rail all diesel", "Some shift from road to rail and water, and more efficient engines", "Greater modal shift to rail and water; more efficient HGVs; more efficient logistics", "Road modal share falls to half; greater hybridisation. Rail freight is all electric "], ["By 2050, 130% passengers increase; 50% more fuel use", "By 2050, 130% passengers increase; 45% more fuel use", "By 2050, 130% passengers increase; 31% more fuel use", "By 2050, 85% passengers increase; 5% more fuel use"], ["no improvements from energy efficiency; between 2007 and 2050 emissions increase by 139%", "1/3 of technical feasible reductions realised; between 2007 and 2050 emissions increase by 78%", "2/3 of technical feasible reductions realised; between 2007 and 2050 emissions increase by 16%", "maximum technical feasible reductions realised; between 2007 and 2050 emissions decrease by 46%"], [nil, nil, nil, nil], ["Average room temperature increases to 20°C (a 2.5°C increase on 2007)", "Average room temperature increases to 18°C (a 0.5°C increase on 2007)", "Average room temperature decreases to 17°C (a 0.5°C decrease on 2007)", "Average room temperature decreases to 16°C (a 1.5°C decrease on 2007)"], ["Over 7M homes insulated, average thermal leakiness falls by 25%", "Over 8M homes insulated, average thermal leakiness falls by 33%", "Over 18M homes insulated, average thermal leakiness falls by 42%", "Over 24M homes insulated, average thermal leakiness decreases by 50% "], ["The proportion of domestic heat supplied using electricity is 0-10%, as today", "The proportion of new domestic heating systems using electricity is 20%", "The proportion of new domestic heating systems supplied using electricity is 30-60%", "The proportion of new domestic heating systems supplied using electricity is 80-100%"], ["The dominant non-electric heat source is gas or gas CHP (biogas if available)", "The dominant non-electric heat source is coal or coal CHP (biomass if available)", "The dominant non-electric heat source is waste heat from power stations", "A mixture of gas/biogas; coal/biomass; and heat from power stations"], [nil, nil, nil, nil], ["Energy demand for domestic lights and appliances increases by 20% (relative to 2007)", "Energy demand for domestic lights and appliances is stable", "Energy demand for domestic lights and appliances decreases by 40%", "Energy demand for domestic lights and appliances decreases by 60%"], ["Energy used for domestic cooking remains at 63% electricity and 37% gas", "Energy used for domestic cooking is entirely electric", "Same as B", "Same as B"], [nil, nil, nil, nil], ["UK industry output more than doubles by 2050", "UK industry grows in line with current trends", "UK industry output falls 30-40% by 2050", "Same as C"], ["No electrification of processes, little improvement in energy intensity", "Some processes electrified; moderate improvements in process emissions and energy demand", "High electrification; CCS captures 48% of emissions; process emissions reduced", "Same as 3"], [nil, nil, nil, nil], ["Space heating demand increases by 50%, hot water demand by 60%, cooling demand by 250%", "Space heating demand increases by 30%, hot water demand by 50%, cooling demand by 60%", "Space heating demand stable, hot water demand increases by 25%, cooling demand stable", "Space heating demand drops by 25%, hot water demand by 10%, cooling demand by 60%"], ["The proportion of non-domestic heat supplied using electricity is 0-10%, as today", "The proportion of non-domestic heat supplied using electricity is 20%", "The proportion of non-domestic heat supplied using electricity is 30-60%", "The proportion of non-domestic heat supplied using electricity is 80-100%"], ["The dominant non-electric heat source is gas or gas CHP (biogas if available)", "The dominant non-electric heat source is coal or coal CHP (biomass if available)", "The dominant non-electric heat source is heat from power stations", "A mixture of gas/biogas, coal/biomass, and heat from power stations"], [nil, nil, nil, nil], ["Energy demand for lights & appliances increases by 33%. Energy for cooking is stable", "Energy demand for lights & appliances increases by 15%; decreases by 5% for cooking", "Energy demand for lights & appliances decreases by 5%; decreases by 20% for cooking", "Energy demand for lights & appliances decreases by 30%; decreases by 25% for cooking"], ["60% electricity and 40% gas (no change from 2007)", "100% electric", "Same as B", "Same as B"], [nil, nil, nil, nil], ["No geosequestration", "Carbon dioxide sequestration rate of 1 million tonnes per annum by 2050", "Carbon dioxide sequestration rate of ~30 million tonnes per annum by 2050", "Carbon dioxide sequestration rate of ~110 million tonnes per annum by 2050"], ["Today’s 3.5 GW storage & 4 GW interconnection with Europe for balancing", "4 GW storage & 10 GW interconnection with Europe for balancing", "7 GW storage with 2 more pumped storage, 15 GW interconnection & some demand shifting", "20 GW storage with large lagoons, 30 GW interconnection & substantial demand shifting"], ["Central case", "Low production case", "Very low production case", nil]])
    assert_equal(workbook.input_example_pathways, [["Doesn't tackle climate change (All at level 1)", "Maximium demand, no supply", "Maximum supply, no demand", "Analogous to MARKAL 3.26", "Higher renewables, more energy efficiency", "Higher nuclear, less energy efficiency", "Higher CCS, more bioenergy", "Low cost pathway", "Friends of the Earth", "Campaign to Protect Rural England", "Mark Brinkley", "National Grid", "Atkins", "Association for Conservation of Energy", "Sustainable Energy Association", nil], [1.0, 1.0, 4.0, 1.8, 1.4, 2.7, 1.5, 2.6, 1.0, 1.0, 2.0, 1.7, 1.6, 1.0, 1.4, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 1.0, 4.0, 1.6, 1.3, 1.0, 2.0, 1.0, 1.7, 1.7, 2.0, 1.7, 1.5, 1.5, 1.2, nil], [1.0, 1.0, 4.0, 2.0, 3.0, 3.0, 3.0, 1.0, 4.0, 2.0, 2.0, 2.0, 2.0, 2.0, 1.0, nil], [1.0, 1.0, 4.0, 1.3, 1.9, 1.2, 1.3, 1.0, 2.3, 2.5, 2.0, 1.6, 2.4, 2.7, 1.6, nil], [1.0, 1.0, 4.0, 1.3, 2.7, 1.4, 1.5, 1.0, 2.3, 1.3, 1.0, 1.6, 1.9, 1.0, 1.2, nil], [1.0, 1.0, 4.0, 2.0, 1.6, 1.0, 1.0, 1.0, 4.0, 2.5, 4.0, 1.0, 1.0, 1.9, 1.0, nil], [1.0, 1.0, 4.0, 2.5, 2.0, 1.0, 1.0, 1.0, 4.0, 2.5, 4.0, 2.0, 1.0, 2.4, 1.0, nil], [1.0, 1.0, 4.0, 2.5, 2.0, 1.0, 1.0, 1.0, 3.0, 2.5, 4.0, 1.0, 2.9, 2.5, 1.0, nil], [1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, nil], [1.0, 1.0, 4.0, 1.0, 1.2, 1.0, 1.0, 1.0, 3.2, 2.0, 1.0, 1.2, 2.7, 1.5, 2.0, nil], [1.0, 1.0, 4.0, 2.0, 1.8, 1.0, 1.0, 1.0, 2.0, 3.0, 3.0, 1.9, 1.6, 2.0, 2.0, nil], [1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 3.0, 4.0, 1.0, 2.6, 1.0, 1.0, nil], [1.0, 1.0, 4.0, 1.5, 2.0, 1.0, 1.0, 1.0, 3.4, 2.0, 1.0, 1.9, 1.9, 1.0, 1.0, nil], [1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1, nil], [1.0, 1.0, 4.0, 1.8, 1.0, 1.0, 1.5, 1.0, 1.0, 3.0, 1.0, 1.0, 1.9, 1.0, 1.0, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 1.0, 4.0, 3.0, 2.0, 4.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 3.0, 3.0, 3.0, nil], [1.0, 1.0, 4.0, 2.0, 2.0, 2.0, 2.0, 2.0, 4.0, 3.0, 4.0, 2.0, 4.0, 4.0, 4.0, nil], [1.0, 1.0, 3.0, 2.0, 2.0, 2.0, 2.0, 4.0, 4.0, 3.0, 3.0, 2.0, 3.0, 4.0, 4.0, nil], [1.0, 1.0, 4.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.0, 1.0, 1.0, nil], [1.0, 1.0, 2.0, 1.0, 1.0, 3.0, 2.0, 3.0, 1.0, 2.0, 2.0, 2.0, 1.0, 1.0, 1.0, nil], [1.0, 1.0, 4.0, 2.5, 2.0, 3.7, 3.0, 2.1, 1.0, 2.0, 1.0, 2.0, 1.0, 1.0, 2.0, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 4.0, 1.0, 4.0, 4.0, 2.0, 3.0, 4.0, 4.0, 4.0, 3.0, 3.0, 3.0, 4.0, 4.0, nil], [1.0, 4.0, 1.0, 3.0, 4.0, 3.0, 2.0, 3.0, 4.0, 4.0, 4.0, 3.0, 3.0, 1.0, 1.0, nil], [1.0, 2.0, 2.0, 1.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 1.0, nil], [1.0, 4.0, 1.0, 4.0, 3.0, 2.0, 3.0, 4.0, 4.0, 4.0, 2.0, 3.0, 4.0, 3.0, 4.0, nil], [1.0, 4.0, 1.0, 1.0, 2.0, 2.0, 2.0, 1.0, 4.0, 4.0, 4.0, 2.0, 2.0, 3.0, 3.0, nil], [1.0, 4.0, 1.0, 1.0, 2.0, 2.0, 2.0, 1.0, 4.0, 3.0, 4.0, 3.0, 4.0, 3.0, 3.0, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 4.0, 1.0, 4.0, 4.0, 2.0, 3.0, 4.0, 3.0, 3.0, 4.0, 2.0, 2.0, 2.0, 4.0, nil], [1.0, 4.0, 1.0, 3.0, 4.0, 3.0, 3.0, 3.0, 4.0, 4.0, 2.0, 3.0, 4.0, 4.0, 4.0, nil], [1.0, 4.0, 1.0, 3.0, 4.0, 3.0, 3.0, 4.0, 3.0, 3.0, 3.0, 4.0, 4.0, 3.0, 4.0, nil], [1.0, 4.0, 1.0, 3.0, 4.0, 3.0, 2.0, 1.0, 3.0, 3.0, 4.0, 1.0, 1.0, 3.0, 1.0, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 4.0, 1.0, 4.0, 4.0, 2.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0, 4.0, nil], [1.0, 2.0, 1.0, 2.0, 2.0, 2.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.0, 2.0, 2.0, 2.0, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 3.0, 2.0, 2.0, 2.0, 2.0, 2.0, 3.0, 2.0, 2.0, 3.0, 2.0, 1.0, 2.0, 2.0, nil], [1.0, 3.0, 1.0, 3.0, 3.0, 1.0, 3.0, 2.0, 3.0, 3.0, 2.0, 2.0, 3.0, 3.0, 3.0, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 4.0, 1.0, 4.0, 4.0, 2.0, 3.0, 4.0, 4.0, 4.0, 3.0, 3.0, 4.0, 4.0, 4.0, nil], [1.0, 4.0, 1.0, 3.0, 4.0, 3.0, 4.0, 4.0, 4.0, 4.0, 3.0, 4.0, 4.0, 3.0, 3.0, nil], [1.0, 4.0, 1.0, 2.0, 4.0, 3.0, 3.0, 4.0, 3.0, 3.0, 4.0, 4.0, 3.0, 3.0, 1.0, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 4.0, 1.0, 4.0, 4.0, 2.0, 3.0, 4.0, 4.0, 4.0, 4.0, 3.0, 4.0, 4.0, 4.0, nil], [1.0, 2.0, 1.0, 2.0, 2.0, 2.0, 1.0, 1.0, 2.0, 1.0, 2.0, 2.0, 2.0, 2.0, 2.0, nil], [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, nil], [1.0, 1.0, 1.0, 2.0, 4.0, 2.0, 2.0, 1.0, 4.0, 3.0, 4.0, 2.0, 3.0, 4.0, 2.0, nil], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, nil], ["Imported natural gas for electricity and heat. Imported oil for vehicles.", nil, nil, "Cost-optimising model based. Mix of supply sources. Ambitious demand reduction.", "Renewables largest supply component. Very ambitious demand reduction. Lots of storage.", "Lots of nuclear. Moderate energy demand reduction. Minimal renewables.", "Lots of CCS and biomass co-firing. Ambitious demand reduction. ", "TBD", "Generation from wind, marine renewables and hydro. Ambitious demand reduction. ", "Offshore renewables, solar, geothermal and electricity imports. Ambitious demand reduction.", "Marine renewables, geothermal and algae supply. Some nuclear and CCS.", "Wide range of generation sources. Moderate demand reduction. Considerable bioenergy.", "Energy from a range of sources. Emphasis on UK self-reliance.", "Ambitious demand side activity, low imports and cost, less large power stations", "energy efficiency and building-level energy production measures; low imports; low cost", nil], [75.0, "No", "No", 112.0, 109.0, 110.0, 111.0, 170.0, 95.0, 96.0, 94.0, 97.0, 92.0, 233.0, 234.0, nil], [12.0, "No", "No", 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, nil]])
    assert_equal(workbook.input_long_descriptions, [["No new nuclear power installed. Final nuclear power station estimated to close in 2035", "~13 3GW nuclear power stations delivering ~280 TWh/yr", "~30 3GW nuclear power stations delivering ~630 TWh/yr", "~50 3GW nuclear power stations delivering ~1030 TWh/yr"], [nil, nil, nil, nil], ["Demonstration plants only; no roll-out of CCS", "~260 TWh/yr from 25-40 CCS power stations; comparable to current gas & coal generation", "~370 TWh/yr from 35-60 CCS power stations; comparable to total current demand", "~550 TWh/yr  from 50-90 CCS power stations; build rate of gas plants in the 1990s"], ["100% coal/biomass, 0% gas/biogas CCS after demonstration plants", "66% coal/biomass, 33% gas/biogas CCS after demonstration plants", "33% coal/biomass, 66% gas/biogas CCS after demonstration plants", "0% coal/biomas, 100% gas/biogas CCS after demonstration plants"], ["~1,400 turbines in 2025, reducing to zero as decommissioned sites are not replanted", "~10,000 turbines in 2050, delivering ~237 TWh/yr", "~17,000 turbines in 2050, delivering ~395 TWh/yr", "~40,000 turbines in 2050, delivering ~929 TWh/yr"], ["~4,400 onshore wind turbines in 2025, reducing to zero as decommissioned sites are not replanted", "~8,000 onshore wind turbines in 2050, delivering ~50 TWh/yr. ", "~13,000 onshore wind turbines in 2050, delivering ~80 TWh/yr", "~20,000 onshore wind turbines in 2050, delivering ~130 TWh/yr"], ["No wave turbines", "~300km of wave farms", "~600km of wave farms", "~900km of wave farms"], ["No tidal stream turbines", "1,000 tidal stream turbines", "4,700 tidal stream turbines", "10,600 tidal stream turbines"], ["No Tidal range projects", "3 small tidal range schemes", "4 tidal range schemes", "8 tidal range schemes"], ["Only existing biomass plants and those already under construction (0.6GW)", "8GW of biomass power stations by 2050 delivering 62TWh/yr", "12GW of biomass power stations by 2050 delivering 100TWh/yr", "Over 20GW of biomass power stations by 2050 delivering 180TWh/yr"], ["No significant solar PV capacity is installed", "4m2 of photovoltaic panels per person in 2050, supplying ~60 TWh/yr of electricity", " 5.4m2 of photovoltaic panels per person in 2050, supplying ~80 TWh/yr", "9.5m2 of photovoltaic panels per person – all suitable roof and facade space used"], ["As today, a negligible proportion of buildings have solar thermal in 2050", "~30% of suitable buildings get ~30% of their hot water from solar thermal", "All suitable buildings get ~30% of their hot water from solar thermal", "All suitable buildings get ~60% of their hot water from solar thermal"], ["No deployment of geothermal electricity generation", "Supply of geothermal electricity grows slowly to 7 TWh/yr in 2035 and is sustained", "Supply of geothermal electricity grows quickly reaching 21 TWh/yr by 2030 and is sustained", "Supply of geothermal electricity grows rapidly reaching 35 TWh/yr by 2030 and is sustained"], ["Supply of hydroelectricity is maintained at current levels of 5 TWh/yr", "Supply of hydroelectricity grows slowly, reaching 7 TWh/yr by 2050", "Supply of hydroelectricity grows more quickly, reaching 8 TWh/yr by 2030 and is sustained", "Supply of hydroelectricity grows rapidly reaching 13 TWh/yr by 2035 and is sustained"], ["As today, no discernable supply of electricity from micro-wind turbines", "Supply of electricity from micro wind turbines increases to 1.3 TWh/yr by 2020 and is sustained", "Micro wind turbines installed in all ~450,000 suitable domestic properties, supplying 3.5 TWh/year from 2020", "Micro wind turbines installed in all suitable domestic and non-domestic sties, supplying 8.9 TWh/year from 2020"], ["No electricity imports, other than for balancing", "30 TWh/yr of electricity imported from Southern Europe", "70 TWh/yr of electricity imported from a 10% share of an internationally coordinated desert solar project ", "140 TWh/yr of electricity imported from a 20% share of an internationally coordinated desert solar project"], [nil, nil, nil, nil], ["Energy crops and food production similar to today", "5% of UK land used for energy crops", "10% of UK land used for energy crops", "17% of UK land used for energy crops"], ["Livestock numbers increase by 10%", "Livestock numbers same as today", "Livestock numbers decrease by 10%", "Livestock numbers decrease by 20%"], ["Overall quantity of waste increases 50% to 2050; 21% increase in recycling rate and 44% increase in rate of energy from waste. 24% of waste is sent to landfill", "Overall quantity of waste increases almost 20% by 2050; recycling and energy from waste rates increase by 36% and 89% respectively. 11% of waste is sent to landfill.", "Overall quantity of waste increases 33%; waste is handled through high-tech and industry-led approaches; by 2050, recycling and energy from waste rates increase by 36% and 89% respectively. Only 2% is sent to landfill.", "Quantity of waste decreases 20% by 2050; recycling and energy from waste increase by 70% and 7% respectively; by 2050, 3% of waste sent to landfill."], ["No development of macro-algae cultivation", "Macro algae covering the same area as half of natural reserve used, delivering ~4 TWh/yr", "Macro algae covering the same area as all of natural reserve used, delivering ~9 TWh/yr", "Macro algae covering the same area as four times natural reserve used, delivering ~46 TWh/yr"], ["Biomass converted to a mixture of solid, liquid and gas biofuels", "Biomass mainly converted to solid biofuel", "Biomass mainly converted to liquid biofuel", "Biomass mainly converted to biogas fuel"], ["Imported biofuel declines from ~ 4 TWh/yr currently to zero", "Up to 70 TWh/yr of imported bioenergy in 2050", "Up to 140 TWh/yr of imported bioenergy in 2050", "Up to 280 TWh/yr of imported bioenergy in 2050"], [nil, nil, nil, nil], [nil, nil, nil, nil], ["In 2050, individuals travel 9% further than today. No noticeable modal shift.", "Individuals travel 7% further than today, cars and vans are 80% of 2050 passenger mileage", "Individuals travel 7% further than today; cars and vans 74% of 2050 passenger mileage", "In 2050, individuals travel the same distance as today. Signficant shift to public transport."], ["By 2050, 20% plug in hybrid electric cars; 2.5% zero emission cars.", "By 2050, 35% conventional petrol or diesel engine cars; 54% plug-in hybrid vehicles; 11%  zero emission vehicles; all buses hybrids; 73% of passenger railway is electrifi", "By 2050, 20% conventional combustion engine cars, with 32% in plug-in hybrid vehicles and 48% in zero emission vehicles: 22% of bus travel fully electric or fuel cell electric ", "By 2050 100%  electric motor or hydrogen fuel cell; all passenger trains electrified; 50% bus  electrified "], ["By 2050, 100% electric", "by 2050, 80% electric,  20% hydrogen fuel cell", "By 2050, 20% electric, 80% hydrogen fuel cell", "By 2050, 100% hydrogen fuel cells"], ["Road haulage makes up 73% of distance, using conventional engines. Rail all diesel", "Some shift from road to rail and water, and more efficient engines", "Greater modal shift to rail and water; more efficient HGVs; more efficient logistics", "Road modal share falls to half; greater hybridisation. Rail freight is all electric "], ["By 2050, international aviation has 130% more passengers but uses only 50% more fuel", "By 2050, international aviation has 130% more passengers but uses only 45% more fuel", "By 2050, international aviation has 130% more passengers but uses only 31% more fuel", "By 2050, international aviation has 85% more passengers but uses only 5% more fuel"], ["no improvements from energy efficiency; between 2007 and 2050 emissions increase by 139%", "1/3 of technical feasible reductions realised; between 2007 and 2050 emissions increase by 78%", "2/3 of technical feasible reductions realised; between 2007 and 2050 emissions increase by 16%", "maximum technical feasible reductions realised; between 2007 and 2050 emissions decrease by 46%"], [nil, nil, nil, nil], ["Average room temperature increases to 20°C (a 2.5°C increase on 2007)", "Average room temperature increases to 18°C (a 0.5°C increase on 2007)", "Average room temperature decreases to 17°C (a 0.5°C decrease on 2007)", "Average room temperature decreases to 16°C (a 1.5°C decrease on 2007)"], ["Over 7M homes insulated, average thermal leakiness falls by 25%", "Over 8M homes insulated, average thermal leakiness falls by 33%", "Over 18M homes insulated, average thermal leakiness falls by 42%", "Over 24M homes insulated, average thermal leakiness decreases by 50% "], ["The proportion of domestic heat supplied using electricity is 0-10%, as today", "The proportion of new domestic heating systems using electricity is 20%", "The proportion of new domestic heating systems supplied using electricity is 30-60%", "The proportion of new domestic heating systems supplied using electricity is 80-100%"], ["The dominant non-electric heat source is gas (biogas if available)", "The dominant non-electric heat source is coal (biomass if available)", "The dominant non-electric heat source is waste heat from power stations", "A mixture of gas/biogas; coal/biomass; and heat from power stations"], [nil, nil, nil, nil], ["Energy demand for domestic lights and appliances increases by 20% (relative to 2007)", "Energy demand for domestic lights and appliances is stable", "Energy demand for domestic lights and appliances decreases by 40%", "Energy demand for domestic lights and appliances decreases by 60%"], ["Energy used for domestic cooking remains at 63% electricity and 37% gas", "Energy used for domestic cooking is entirely electric", "Energy used for domestic cooking is entirely electric", "Energy used for domestic cooking is entirely electric"], [nil, nil, nil, nil], ["UK industry output more than doubles by 2050", "UK industry grows in line with current trends", "UK industry output falls 30-40% by 2050", "UK industry output falls 30-40% by 2050"], ["No electrification of industrial processes and little improvement in industrial energy intensity", "Some industrial processes electrified and moderate improvements in process emissions and energy demand", "Many industrial processes electrified, CCS captures 48% of emissions and  substantial improvements in process emissions and energy demand", "Many industrial processes electrified, CCS captures 48% of emissions and  substantial improvements in process emissions and energy demand"], [nil, nil, nil, nil], ["Commercial space heating demand increases by 50%, hot water demand by 60%, cooling demand by 250%", "Commercial space heating demand increases by 30%, hot water demand by 50%, cooling demand by 60%", "Commercial space heating demand stable, hot water demand increases by 25%, cooling demand stable", "Commercial space heating demand drops by 25%, hot water demand by 10%, cooling demand by 60%"], ["The proportion of non-domestic heat supplied using electricity is 0-10%, as today", "The proportion of non-domestic heat supplied using electricity is 20%", "The proportion of non-domestic heat supplied using electricity is 30-60%", "The proportion of non-domestic heat supplied using electricity is 80-100%"], ["The dominant non-electric heat source is gas (biogas if available)", "The dominant non-electric heating fuel is coal (biomass if available)", "The dominant non-electric heat source is heat from power stations", "A mixture of gas/biogas, coal/biomass, and heat from power stations"], [nil, nil, nil, nil], ["Energy demand for commercial lights & appliances increases by 33%. Energy for cooking is stable", "Energy demand for commercial lights & appliances increases by 15%; decreases by 5% for cooking", "Energy demand for commercial lights & appliances decreases by 5%; decreases by 20% for cooking", "Energy demand for commercial lights & appliances decreases by 30%; decreases by 25% for cooking"], ["Energy used for commercial cooking is 60% electricity and 40% gas (no change from 2007)", "Energy used for commercial cooking is 100% electric", "Energy used for commercial cooking is 100% electric", "Energy used for commercial cooking is 100% electric"], [nil, nil, nil, nil], ["No geosequestration", "Carbon dioxide sequestred at a rate of 1 million tonnes per annum by 2050", "Carbon dioxide  sequestred at a rate of ~30 million tonnes per annum by 2050", "Carbon dioxide sequestred at a rate of ~110 million tonnes per annum by 2050"], ["Today’s 3.5 GW of pumped storage and 4 GW interconnection with Europe available for balancing electricity supply and demand", "4 GW of pumped storage and 10 GW interconnection with Europe available for balancing electricity supply and demand", "7 GW of pumped storage (includign 2 more sites), 15 GW of interconnection with Europe and some demand shifting available for balancing electricity supply and demand", "20 GW of pumped storage with large lagoons, 30 GW of interconnection with Europe and substantial demand shifting available for balancing electricity supply and demand"], [nil, nil, nil, nil]])
    assert_equal(workbook.input_names, [["Nuclear power stations"], ["Carbon Capture Storage (CCS)"], ["CCS power stations"], ["Choice of CCS power station fuel"], ["Offshore wind"], ["Onshore wind"], ["Wave"], ["Tidal Stream"], ["Tidal Range"], ["Biomass power stations"], ["Solar panels for electricity"], ["Solar panels for hot water"], ["Geothermal electricity"], ["Hydroelectric power stations"], ["Small-scale wind"], ["Electricity imports"], ["Agriculture and land use"], ["Land dedicated to bioenergy"], ["Livestock and their management"], ["Volume of waste and recycling"], ["Marine algae"], ["Type of fuels from biomass"], ["Bioenergy imports"], [nil], ["Domestic passenger transport"], ["Domestic transport behaviour"], ["Shift to zero emission transport"], ["Choice of zero-emission technology"], ["Domestic freight"], ["International aviation"], ["International shipping"], ["Domestic space heating and hot water"], ["Average temperature of homes"], ["Home insulation"], ["Home heating electrification"], ["Home heating that isn't electric"], ["Domestic lighting, appliances, and cooking"], ["Home lighting & appliances"], ["Electrification of home cooking"], ["Industrial processes"], ["Growth in industry"], ["Energy intensity of industry"], ["Commercial heating and cooling"], ["Commercial demand for heating and cooling"], ["Commercial heating electrification"], ["Commercial heating that isn't electric"], ["Commercial lighting, appliances, and catering"], ["Commercial lighting & appliances"], ["Electrification of commercial cooking"], [nil], ["Geosequestration"], ["Storage, demand shifting & interconnection"], ["Indigenous fossil-fuel production"]])
    assert_equal(workbook.input_onepagenotes, [["0.pdf"], ["2.pdf"], ["2.pdf"], ["3.pdf"], ["4.pdf"], ["5.pdf"], ["6.pdf"], ["TidalStream.pdf"], ["TidalRange.pdf"], ["7.pdf"], ["8.pdf"], ["9.pdf"], ["10.pdf"], ["11.pdf"], ["12.pdf"], ["13.pdf"], [nil], ["15.pdf"], ["16.pdf"], ["17.pdf"], ["18.pdf"], ["19.pdf"], ["20.pdf"], [nil], [nil], ["23.pdf"], ["24.pdf"], ["FuelCellsOrBatteries.pdf"], ["25.pdf"], ["InternationalAviation.pdf"], ["InternationalShipping.pdf"], [nil], ["29.pdf"], ["30.pdf"], ["31.pdf"], ["31.pdf"], [nil], ["34.pdf"], ["35.pdf"], [nil], ["37.pdf"], ["38.pdf"], [nil], ["40.pdf"], ["31.pdf"], ["31.pdf"], [nil], ["44.pdf"], ["35.pdf"], [nil], ["47.pdf"], ["48.pdf"], [nil]])
    assert_equal(workbook.input_types, [[4.0], [nil], [4.0], ["D"], [4.0], [4.0], [4.0], [4.0], [4.0], [4.0], [4.0], [4.0], [4.0], [4.0], [4.0], [4.0], [nil], [4.0], [4.0], ["D"], [4.0], ["D"], [4.0], [nil], [nil], [4.0], [4.0], ["D"], [4.0], [4.0], [4.0], [nil], [4.0], [4.0], ["D"], ["D"], [nil], [4.0], ["B"], [nil], ["C"], [3.0], [nil], [4.0], ["D"], ["D"], [nil], [4.0], ["B"], [nil], [4.0], [4.0], [3.0]])
    assert_equal(workbook.output_airquality, [["High", 21.53196553841394], ["Low", 6.532508360862482]])
    assert_equal(workbook.output_areas, [["Vector", 2007.0, 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["III.a.1", 227.50727999999998, 524.8079999999998, 1124.8079999999998, 1724.8079999999995, 2185.6079999999997, 2404.0079999999994, 2404.0079999999994, 2404.0079999999994, 2404.0079999999994, 2404.0079999999994], ["III.b", 42.31636363636362, 52.36363636363635, 52.36363636363635, 52.36363636363635, 52.36363636363635, 52.36363636363635, 52.36363636363635, 52.36363636363635, 52.36363636363635, 52.36363636363635], ["IV.a", 0.08818181818181817, 0.21217462545454543, 0.9166793244624091, 3.960421667278402, 10.061822748137125, 25.56300452837943, 47.726704351141244, 89.10683036856841, 166.3644562573475, 310.60618126941864], ["IV.b", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["IV.c", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["VI.a.Biocrop", 3639.4, 1943.094128773601, 4550.04397286129, 7081.55419183146, 9540.6895626117, 11930.39035385429, 15003.47738415439, 18012.6568747754, 20960.5251052297, 23849.5728797235], ["VI.a.Forestry", 24369.699999999997, 24711.44, 25815.04, 26918.64, 28022.24, 29125.839999999997, 30229.44, 31333.04, 32436.640000000003, 33540.24], ["III.a.2", 44.57815999999999, 188.1320000000001, 1005.732, 2747.4423999999995, 5634.207999999999, 8947.439999999999, 11552.399999999996, 12743.999999999998, 12959.999999999996, 12959.999999999996], ["III.c.TidalStream", 0.0, 0.10569930661254866, 0.42279722645019463, 1.0569930661254865, 2.6424826653137132, 2.6424826653137132, 0.0, 0.0, 0.0, 0.0], ["III.c.TidalRange", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["VI.c", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["V.b", 835.8316221765912, 4421.720990366231, 10523.504307516527, 16625.287624666827, 22727.07094181713, 14202.563816861124, 17306.42130359192, 20410.278790322714, 23514.136277053512, 26617.99376378431], ["VII.a", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["III.c.Wave", 0.0, 0.0, 0.03805175038051751, 2.0082868256384225, 5.020717064096051, 5.020717064096051, 0.0, 0.0, 0.0, 0.0], ["I.a", 31.290833849434243, 28.509207062841817, 22.34452553734592, 18.65634301404831, 15.66216562919653, 10.459427501011545, 6.922138242554577, 5.360302247865843, 5.050157801004337, 4.007399035367567], ["I.b", 0.0, 0.0, 0.7083333333333335, 1.416666666666667, 1.641666666666667, 2.1166666666666676, 2.741666666666668, 3.3666666666666685, 3.99166666666667, 4.61666666666667], ["II.a", 3.6666666666666665, 3.3333333333333335, 2.4, 1.2000000000000002, 0.4000000000000002, 0.4000000000000002, 0.0, 0.0, 0.0, 0.0], ["III.d", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["VII.c", 0.0, 0.0, 0.0, 6.504106879815487, 19.963303535318033, 34.70836706285803, 46.901079914703345, 55.80929491777153, 63.141083640874754, 71.90480017706659], ["VI.b", 43.99784119293418, 45.70304186046512, 55.65071511627907, 65.09603255813953, 59.84948395348837, 54.82519953488373, 50.5747483139535, 46.48041395348837, 42.542196453488366, 38.760095813953484]])
    assert_equal(workbook.output_capacity_automaticallybuilt, [["GW installed capacity", 2007.0, 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Automatically built CCGT gas", 30.343667698868483, 24.823614125683637, 21.26705107469184, 20.257686028096614, 22.71233125839306, 19.11885500202309, 13.244276485109154, 10.120604495731687, 9.500315602008675, 7.414798070735134], ["Automatically built peaking gas", 0.0, 0.0, 0.0, 6.504106879815487, 19.963303535318033, 34.70836706285803, 46.901079914703345, 55.80929491777153, 63.141083640874754, 71.90480017706659]])
    assert_equal(workbook.output_costpercapita_detail, [["name", "low", "point", "high", "range", "finance_low", "finance_point", "finance_high", "finance_range"], ["Conventional thermal plant", 14.125602765513053, 38.45375654733542, 80.64382036751374, 66.51821760200069, 0.0, -0.4807003349584114, 10.556067600126049, 10.556067600126049], ["Combustion + CCS", 1.7638345164120897, 4.390257811264183, 12.798820460086468, 11.034985943674378, 0.0, -0.26532809230990967, 7.704592781034465, 7.704592781034465], ["Nuclear power", 1.0603220663865833, 3.9106837439061213, 6.8716031656694145, 5.811281099282831, 0.0, 0.0, 0.0, 0.0], ["Onshore wind", 13.405867244925041, 23.55818063428003, 42.992970604255085, 29.587103359330044, 0.0, -2.302365339345389, 22.879523059126505, 22.879523059126505], ["Offshore wind", 79.88706564292255, 126.24117123317893, 295.0313256672139, 215.14426002429133, 0.0, -9.33950451664409, 146.99352333692974, 146.99352333692974], ["Hydroelectric", 0.41873916343628526, 2.5665402883905393, 6.050439303842557, 5.631700140406272, 0.0, -0.08422087563320674, 1.3318665385655237, 1.3318665385655237], ["Wave and Tidal", 0.27818041908682045, 0.985134887274277, 2.0962143177992982, 1.8180338987124778, 0.0, -0.08271513483644337, 1.058330187932497, 1.058330187932497], ["Geothermal", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Distributed solar PV", 14.713947908315781, 48.296048763302494, 126.64627641592523, 111.93232850760944, 0.0, -6.205042495520708, 18.54810163144695, 18.54810163144695], ["Distributed solar thermal", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Micro wind", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Biomatter to fuel conversion", 4.851645258109791, 45.757227105787024, 118.08602632460445, 113.23438106649465, 0.0, -0.23478423660128478, 43.79797159469703, 43.79797159469703], ["Bioenergy imports", 25.612172605417655, 101.88827200536194, 133.5421848469154, 107.93001224149775, 0.0, 0.0, 0.0, 0.0], ["Agriculture and land use", 12.780084447512392, 54.68203645976505, 70.31202470455017, 57.531940257037775, 0.0, 0.0, 0.0, 0.0], ["Energy from waste", 10.707926235485655, 4.045292334269769, 3.377426320310319, -7.330499915175336, 0.0, -1.1425201586494602, 2.3040464238460237, 2.3040464238460237], ["Waste arising", 84.9935210077271, 112.11778909850426, 162.491429838519, 77.4979088307919, 0.0, -6.1371208328465565, 31.004042598140458, 31.004042598140458], ["Marine algae", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Electricity imports", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Electricity Exports", -5.182506828439416e-15, -1.8967974992088257e-14, -4.4569558724578975e-14, -3.938705189613956e-14, 0.0, 0.0, 0.0, 0.0], ["Electricity grid distribution", 36.04925917393896, 71.56325664054171, 330.9760826155599, 294.92682344162097, 0.0, -6.87749921374878, 219.88100537484718, 219.88100537484718], ["Storage, demand shifting, backup", 17.980321268323024, 26.147289349442385, 46.71794610239877, 28.737624834075746, 0.0, -1.2887491203410455, 13.541841365118417, 13.541841365118417], ["H2 Production", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Domestic heating", 246.7899194688976, 307.1346006869647, 419.2032943776608, 172.41337490876322, 0.0, -38.19533878210795, 180.39920193010238, 180.39920193010238], ["Domestic insulation", 1.6165212602831227, 6.139289851640341, 13.4205921204588, 11.804070860175678, 0.0, -0.5307894593099064, 15.6685816198988, 15.6685816198988], ["Commercial heating and cooling", 37.79376188356939, 46.98384966325793, 64.05115581677484, 26.25739393320545, 0.0, -5.492307530869325, 32.952351095696905, 32.952351095696905], ["Domestic lighting, appliances, and cooking", 41.45687641019699, 48.628908244808684, 62.18531461529548, 20.72843820509849, 0.0, -7.6912411482175065, 37.6988363148168, 37.6988363148168], ["Commercial lighting, appliances, and catering", 4.014861950359359, 5.420063632985134, 8.029723900718718, 4.014861950359359, 0.0, -0.09202308753182459, 5.679630367353962, 5.679630367353962], ["Industrial processes", 67.59752329634196, 91.57764010899788, 136.1121427610732, 68.51461946473123, 0.0, -0.03649069771434258, 1.665601331349027, 1.665601331349027], ["Conventional cars and buses", 560.2275778061564, 660.6505819777308, 725.7108615384105, 165.4832837322541, 0.0, -38.16574248779571, 216.94520837683694, 216.94520837683694], ["Hybrid cars and buses", 283.56160760267704, 399.8240707248467, 613.5878987149154, 330.0262911122383, 0.0, -4.9571640946434385, 330.1539556202814, 330.1539556202814], ["Electric cars and buses", 401.0374308213211, 654.0152639943822, 1340.9609121785027, 939.9234813571816, 0.0, -73.78343279441664, 432.17246533489106, 432.17246533489106], ["Fuel cell cars and buses", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Bikes", 38.222773146097666, 48.008157906863396, 78.16506440544849, 39.942291259350824, 0.0, -0.6519192658056503, 14.590877075147157, 14.590877075147157], ["Rail", 126.62443449982064, 140.6862082865004, 166.57490749550956, 39.950472995688926, 0.0, -0.643157299252314, 2.881406385840021, 2.881406385840021], ["Domestic aviation", 12.416009711502463, 13.505470843368165, 15.528755802547323, 3.11274609104486, 0.0, -1.9706747587314553, 11.116216910197654, 11.116216910197654], ["Domestic freight", 135.50867397547938, 146.26991987043655, 156.86691146607353, 21.35823749059415, 0.0, -4.756554647040498, 29.02681269405915, 29.02681269405915], ["International aviation", 35.73444260848808, 35.73444260848808, 35.73444260848808, 0.0, 0.0, 0.0, 0.0, 0.0], ["International shipping (maritime bunkers)", 18.064825489879357, 18.064825489879357, 18.064825489879357, 0.0, 0.0, 0.0, 0.0, 0.0], ["Geosequestration", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Petroleum refineries", 12.730760740700433, 14.621273785724501, 18.132226583626345, 5.401465842925912, 0.0, -0.5764102823263727, 4.55571743015879, 4.55571743015879], ["Fossil fuel transfers", 6.6756100769026325, 8.712715400822137, 12.490951265663615, 5.815341188760982, 0.0, -0.9058401616711821, 7.301947954187016, 7.301947954187016], ["District heating effective demand", 0.24595000079820212, 0.3320325010775729, 0.49190000159640423, 0.24595000079820212, 0.0, -0.03658051765496824, 0.2395530339484827, 0.2395530339484827], ["Storage of captured CO2", 2.1163095166418504, 4.989899496750571, 10.737079456968011, 8.620769940326161, 0.0, -0.2044748063035142, 4.953485242734012, 4.953485242734012], ["Coal", 7.02968745662907, 5.650483546500083, 3.581677681306598, -3.448009775322472, 0.0, 0.0, 0.0, 0.0], ["Oil", 221.29371814353053, 291.01306093192443, 348.97286482675196, 127.67914668322146, 0.0, 0.0, 0.0, 0.0], ["Gas", 113.10877341008029, 146.7132292160452, 187.03857618320308, 73.92980277312279, 0.0, 0.0, 0.0, 0.0], ["Finance cost", 0.0, 579.7147302576233, 1847.6027612093103, 1847.6027612093103, 0.0, 0.0, 0.0, 0.0]])
    assert_equal(workbook.output_diversity, [["Vector", 2007.0, 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Nuclear fission", 0.061775700100290154, 0.06613431614104014, 0.05994518596121601, 0.03740675676452841, 0.013387338473403183, 0.015166663790901905, 0.0, 0.0, 0.0, 0.0], ["Solar", 6.409128608569515e-06, 1.6838428508301234e-05, 7.850073224528712e-05, 0.000370366324982128, 0.0010102577009152458, 0.0029077912137542524, 0.005757194477006156, 0.011264256498257375, 0.021608007915053188, 0.041658470330052655], ["Wind", 0.002247204352421681, 0.00642951809312634, 0.02073305462626772, 0.04752624514285933, 0.0892214689702276, 0.14673033695105603, 0.19131121890398328, 0.2176027548820299, 0.22676500706745376, 0.2341612766258982], ["Tidal", 0.0, 2.0589762185878015e-06, 8.88708799757102e-06, 2.426237336844153e-05, 6.512364995234262e-05, 7.377930315468306e-05, 0.0, 0.0, 0.0, 0.0], ["Wave", 0.0, 0.0, 1.3330631996356525e-06, 7.683084900006477e-05, 0.0002062248915157514, 0.00023363445998982944, 0.0, 0.0, 0.0, 0.0], ["Geothermal", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Hydro", 0.0015506093786544224, 0.0021932544116592227, 0.002366667082105152, 0.002584466831003781, 0.0027748301563053864, 0.0031436357675687578, 0.0033337294551326353, 0.0034935940083547406, 0.00358950930764972, 0.0037065863591986188], ["Electricity imports", 2.1422787552522786e-17, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Environmental heat", 0.0, 0.0, 0.0, 0.01628037921164247, 0.0345980960660255, 0.05793322523271254, 0.08130535690051056, 0.10573623293544986, 0.12951462341184816, 0.15513399378263873], ["Waste", 0.017211183416148922, 0.01882139482549045, 0.03238063708122385, 0.05929708543922305, 0.07854229367028191, 0.09192059126466415, 0.09604313443806324, 0.1000985308094984, 0.10268067715341825, 0.1044036642710628], ["Agriculture", 0.0018397171668308597, 0.002551303528002338, 0.009338727481156125, 0.017901880624256777, 0.02807537801215139, 0.042540962238126666, 0.060472518455076646, 0.08068821569763868, 0.10203067399809167, 0.1265794420468757], ["Biomass imports", 0.0016567893901976466, 0.009570354344651569, 0.024577925558872837, 0.04240214252156157, 0.062233975474190156, 0.04406021803210114, 0.05693578269347302, 0.07036700101058022, 0.08329362930377716, 0.09736370979678635], ["Coal reserves", 0.04688146379690705, 0.052644907373052496, 0.05680734923315262, 0.06203521862472412, 0.06660452876697423, 0.037728503569513405, 0.04000992256969942, 0.04192854508605523, 0.04307967739888683, 0.04448478355108171], ["Coal imports", 0.13034235311851258, 0.11826719218171346, 0.08509657408206764, 0.037520403845562635, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Oil reserves", 0.36778769556499713, 0.3302592248850772, 0.2872245134735661, 0.24332515611063676, 0.20214847993769394, 0.17720840726351464, 0.14541207757408556, 0.1179127009884957, 0.0937435215027734, 0.07490284776823276], ["Oil imports", 0.0, 0.011644283547404148, 0.04948828831259844, 0.08383077694507571, 0.07613497178701573, 0.0630175441847633, 0.07552720185110583, 0.07111451126946981, 0.06286614665594231, 0.04825976461178668], ["Gas reserves", 0.2754946485404195, 0.26574419047797315, 0.2201990081675302, 0.18578107582618691, 0.15434229111262582, 0.13530030792168307, 0.11102350715250876, 0.09002747103243977, 0.07157407213827799, 0.05718903817121229], ["Gas imports", 0.09320622604601139, 0.11572116278608255, 0.15175334805680094, 0.1636369525653878, 0.19065474133072183, 0.18203439880649575, 0.13286835552935483, 0.08976618578173033, 0.05925445414682764, 0.012156422685173569]])
    assert_equal(workbook.output_electricity_capacity, [["Sector", 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Oil / Biofuel", 4.0568, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Coal / Biomass", 28.137999999999998, 23.422, 17.055000000000003, 8.612, 1.7999999999999998, 0.6, 0.6, 0.6, 0.6], ["Gas / Biogas", 24.823614125683637, 21.26705107469184, 20.257686028096614, 22.71233125839306, 19.11885500202309, 13.244276485109154, 10.120604495731687, 9.500315602008675, 7.414798070735134], ["CCS Power", 0.0, 0.8500000000000001, 1.7000000000000002, 1.9700000000000004, 2.540000000000001, 3.2900000000000014, 4.040000000000002, 4.790000000000004, 5.540000000000004], ["Nuclear power", 10.0, 7.2, 3.6000000000000005, 1.2000000000000006, 1.2000000000000006, 0.0, 0.0, 0.0, 0.0], ["Onshore wind", 4.373399999999999, 9.3734, 14.3734, 18.2134, 20.0334, 20.0334, 20.0334, 20.0334, 20.0334], ["Offshore wind", 1.343800000000001, 7.183800000000001, 18.5638, 35.2138, 52.019999999999996, 64.17999999999999, 70.8, 72.0, 72.0], ["Hydroelectric power stations", 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6], ["Wave", 0.0, 0.0015220700152207, 0.0803314730255369, 0.200828682563842, 0.200828682563842, 0.0, 0.0, 0.0, 0.0], ["Tidal Stream", 0.00158548959918823, 0.00634195839675292, 0.0158548959918823, 0.0396372399797057, 0.0396372399797057, 0.0, 0.0, 0.0, 0.0], ["Tidal Range", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Geothermal electricity", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Solar PV", 0.04812208, 0.207906650909, 0.898239965774483, 2.28206289133007, 5.79779484148812, 10.8246133579908, 20.2097965784382, 37.7321447181613, 70.4467627621362], ["Standby / peaking gas", 0.0, 0.0, 6.504106879815487, 19.963303535318033, 34.70836706285803, 46.901079914703345, 55.80929491777153, 63.141083640874754, 71.90480017706659], ["Total generation", 74.38532169528283, 71.11202175401282, 84.648419242704, 112.00736360758471, 139.05888282891277, 160.6733697578033, 183.2130959919414, 209.3969439610447, 249.53976100993793]])
    assert_equal(workbook.output_electricity_demand, [["Sector", 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Transport", 8.26449747617325, 9.740061020187353, 11.078513555023555, 29.944824653504085, 45.71311025736983, 49.61244326699631, 52.77203818621336, 57.4178178165824, 61.66025717555643], ["Industry", 127.48975695016398, 127.46977421310308, 126.27593852339321, 124.21509371213732, 120.97523959773889, 117.75226837238516, 119.2478770217631, 119.47485206123366, 118.68051559047333], ["Heating and cooling", 56.307058666224584, 47.69825393689411, 64.34723623065716, 80.95088271352331, 97.23202647100274, 114.16164204508175, 131.2636780974999, 148.56296128922216, 166.11639660294728], ["Lighting & appliances", 142.01665021575684, 135.35761865956107, 129.5138376125313, 124.39923607130422, 119.93742428197085, 116.17788043274271, 112.8305227144786, 109.95697950391099, 107.51244796997688], ["Total", 334.07796330831866, 320.26570782974557, 331.2155259216052, 359.510037150469, 383.8578006080823, 397.70423411720594, 416.11411601995496, 435.41261067094916, 453.96961733895387]])
    assert_equal(workbook.output_electricity_ghg, [["Source", 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Fuel combustion", 182.04759704951604, 154.44588484860714, 133.0129002032083, 97.30754740852497, 55.79172215597063, 36.6793832093029, 29.85398460918162, 28.771286239991213, 24.28561684980587], ["Bioenergy credit", -10.303881340385615, -20.537609815179923, -36.85564267449664, -51.797087260776244, -24.628508319567807, -21.96625106389451, -25.862152456211348, -30.08550631671345, -34.91538429811568], ["Total", 171.7437157091304, 133.9082750334272, 96.15725752871165, 45.510460147748724, 31.163213836402825, 14.713132145408387, 3.9918321529702716, -1.3142200767222363, -10.629767448309813]])
    assert_equal(workbook.output_electricity_supply, [["Sector", 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Conventional", 285.4427632902615, 242.71840431629516, 215.58557100560643, 186.24096226775148, 128.36227806341407, 86.00316936792677, 66.83569330670878, 63.02947659704563, 50.232323921644934], ["CCS Power", 0.0, 5.079787425, 10.834644510000002, 12.581540002800004, 16.254500139, 21.078193257000006, 25.94659297500001, 30.86968376700002, 35.80179039000002], ["Nuclear power", 52.596, 44.18064, 25.246080000000006, 8.415360000000005, 8.415360000000005, 0.0, 0.0, 0.0, 0.0], ["Onshore wind", 11.501167319999997, 24.650167319999998, 37.799167319999995, 47.89759932, 52.68383532, 52.68383532, 52.68383532, 52.68383532, 52.68383532], ["Offshore wind", 4.122912780000003, 22.040616780000004, 60.210200196, 123.47366832, 196.0831476, 253.17084599999995, 279.28476, 284.0184, 284.0184], ["Hydroelectric power stations", 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001], ["Tidal & Wave", 0.0050034246575342495, 0.023015753424657545, 0.20847602739726018, 0.5211900684931499, 0.5211900684931499, 0.0, 0.0, 0.0, 0.0], ["Geothermal electricity", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Solar PV", 0.04091830086816001, 0.17678344108122454, 0.7637752393779744, 1.9404426406237414, 4.929876549307031, 9.204190387526294, 17.184430450239162, 32.08371811814199, 59.90102327016994], ["Electricity imports", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Total", 359.03849311578716, 344.199143035801, 355.9776422983817, 386.40049061966835, 412.5799157402142, 427.469962332453, 447.26504005194795, 468.0148418021876, 487.9671009018149]])
    assert_equal(workbook.output_emissions_percentage_reduction, 0.8926508976630851)
    assert_equal(workbook.output_finalenergyde, [["Transport", 688.2457797049984, 657.557331998461, 604.9986948656235, 511.82664157391963, 427.0821561364031, 402.3750491442318, 365.1312952043678, 337.5275538637793, 309.19871705345406], ["Industry", 448.25583034349745, 399.20490431360133, 354.91958371388057, 316.34986301889035, 282.14544901043104, 252.79010442000708, 227.03871348851433, 204.38602974466409, 184.4086545804215], ["Heating & cooling", 504.6201785605084, 489.10189288794095, 474.786386477912, 458.7291254224954, 441.18966103292223, 427.3169599006943, 413.8807105139482, 401.00428048004324, 388.71710785711196], ["Lighting & appliances", 157.7183708322827, 148.7674546632581, 140.7337885835767, 133.52729432306373, 127.06752557712352, 121.40553064620451, 116.23458997876243, 111.61965791614654, 107.51244796997688], ["Total", 1798.8401594412871, 1694.6315838632613, 1575.438453640993, 1420.432924338369, 1277.4847917568798, 1203.887644111138, 1122.2853091855927, 1054.537522004633, 989.8369274609644]])
    assert_equal(workbook.output_finalenergydemand, [["Vector", 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Transport", 688.2457797049984, 657.557331998461, 604.9986948656235, 511.82664157391963, 427.0821561364031, 402.3750491442318, 365.1312952043678, 337.5275538637793, 309.19871705345406], ["Industry", 448.25583034349745, 399.20490431360133, 354.91958371388057, 316.34986301889035, 282.14544901043104, 252.79010442000708, 227.03871348851433, 204.38602974466409, 184.4086545804215], ["Heating & cooling", 504.6201785605084, 489.10189288794095, 474.786386477912, 458.7291254224954, 441.18966103292223, 427.3169599006943, 413.8807105139482, 401.00428048004324, 388.71710785711196], ["Lighting & appliances", 157.7183708322827, 148.7674546632581, 140.7337885835767, 133.52729432306373, 127.06752557712352, 121.40553064620451, 116.23458997876243, 111.61965791614654, 107.51244796997688], ["Total", 1798.8401594412871, 1694.6315838632613, 1575.438453640993, 1420.432924338369, 1277.4847917568798, 1203.887644111138, 1122.2853091855927, 1054.537522004633, 989.8369274609644]])
    assert_equal(workbook.output_flows, [["From", "To", "2007", "2010", "2015", "2020", "2025", "2030", "2035", "2040", "2045", "2050"], ["Coal reserves", "Coal", 124.395701394218, 127.93, 127.93, 127.93, 127.93, 63.965, 63.965, 63.965, 63.965, 63.965], ["Coal imports", "Coal", 345.85158236078604, 287.39573589887635, 191.63725942638484, 77.37516479146888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Oil reserves", "Oil", 975.891208349798, 802.547952837212, 646.828843533316, 501.788950072749, 388.274724214433, 300.439580110198, 232.474419959775, 179.884274621243, 139.191022657933, 107.703360003839], ["Oil imports", "Oil", 0.0, 28.296244946608567, 111.44749419386642, 172.87714192578505, 146.23550561838766, 106.84010316898906, 120.7474835271164, 108.49028278981493, 93.34408504533644, 69.39307324825394], ["Gas reserves", "Natural Gas", 731.0, 645.772895884115, 495.88758312335, 383.12064593856, 296.451452589944, 229.388482908284, 177.496435356475, 137.343358153041, 106.273672431058, 82.2325418852722], ["Gas imports", "Natural Gas", 247.31424585054333, 281.20874542181105, 341.74813785496434, 337.4546879302331, 366.1982377170308, 308.62157833013873, 212.4204151265127, 136.94474878018232, 87.98141927589663, 17.47981028533563], ["UK land based bioenergy", "Bio-conversion", 4.881522222222221, 6.199806906762808, 21.030789550854053, 36.9175387631892, 53.92550890436536, 72.12405455064454, 96.67913343847387, 123.0956549173465, 151.49584343119, 182.0095179564277], ["Marine algae", "Bio-conversion", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Agricultural 'waste'", "Bio-conversion", 3.4811481886666664, 9.098265251876953, 31.9993820254925, 77.72281609107452, 108.54864751369526, 116.11383365382221, 115.96102247134834, 117.41311066977381, 119.68113553610664, 119.96250783299459], ["Other waste", "Bio-conversion", 35.01597669082142, 29.518496728975208, 32.472974098092855, 34.948489661246896, 33.54083121407032, 31.762300423979358, 30.30805451532839, 28.67492168865894, 26.78865430616038, 24.767283270734204], ["Other waste", "Solid", 7.1711853539826516, 7.120255333333333, 8.448752812500002, 9.612073083333332, 8.769866954166666, 7.966267925, 7.277810879166668, 6.619449145833334, 5.991182725, 5.3930116166666675], ["Biomass imports", "Solid", 4.39614, 13.85687441860465, 29.624765116279068, 45.39265581395349, 61.160546511627906, 0.0, 0.0, 0.0, 0.0, 0.0], ["Biofuel imports", "Liquid", 0.0, 9.399609302325581, 25.72465813953488, 42.04970697674418, 58.374755813953485, 74.6998046511628, 91.02485348837209, 107.34990232558138, 123.67495116279069, 140.0], ["Coal", "Solid", 470.24728375500405, 415.32573589887636, 319.56725942638485, 205.30516479146888, 127.93, 63.965, 63.965, 63.965, 63.965, 63.965], ["Oil", "Liquid", 975.891208349798, 830.8441977838206, 758.2763377271824, 674.6660919985341, 534.5102298328206, 407.27968327918705, 353.2219034868914, 288.37455741105794, 232.53510770326943, 177.09643325209294], ["Natural Gas", "Gas", 978.3142458505433, 926.981641305926, 837.6357209783143, 720.5753338687931, 662.6496903069748, 538.0100612384227, 389.9168504829877, 274.28810693322333, 194.25509170695463, 99.71235217060783], ["Solar", "Solar PV", 0.01700604, 0.04091830086816001, 0.17678344108122454, 0.7637752393779744, 1.9404426406237414, 4.929876549307031, 9.204190387526294, 17.184430450239162, 32.08371811814199, 59.90102327016994], ["Solar PV", "Electricity grid", 0.01700604, 0.04091830086816001, 0.17678344108122454, 0.7637752393779744, 1.9404426406237414, 4.929876549307031, 9.204190387526294, 17.184430450239162, 32.08371811814199, 59.90102327016994], ["Solar", "Solar Thermal", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Bio-conversion", "Solid", 14.467592565398165, 20.160631585339683, 39.503786508092276, 80.6880655520772, 129.75208188062737, 153.41594028983158, 175.96239536778182, 201.83393209509097, 230.3970290741609, 259.1124163659772], ["Bio-conversion", "Liquid", 1.2583829999999998, 0.37401453680050345, 0.39553824310274843, 0.4183005909213054, 0.45093491670622354, 0.4768852201132515, 0.5043289058731822, 0.533351914825203, 0.5640451335130127, 0.5965046787991366], ["Bio-conversion", "Gas", 22.003982326267895, 18.98814129098875, 33.064126531539955, 46.36738612918278, 50.61329569943278, 49.548195461216515, 48.72155554405494, 47.677534642218546, 46.351179411512135, 44.84097543715891], ["Bio-conversion", "Losses", 5.648689210044246, 5.293781474486025, 12.539694391704444, 22.115092243329343, 15.198675135364539, 16.559167657284775, 17.75993060744068, 19.1388686236445, 20.653379654270964, 22.18941257822121], ["Solid", "Over generation / exports", 0.0, 0.0, 0.0, 0.0, 122.44813016183303, 125.06755396376379, 160.14486134180922, 178.4384256222709, 200.37713363672674, 222.5148692150999], ["Liquid", "Over generation / exports", 74.9734963011175, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Gas", "Over generation / exports", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Solid", "Thermal generation", 426.5928682890119, 392.9591632927247, 343.4323038080406, 294.538574, 165.24169168695653, 66.26909489361702, 58.28659500000002, 69.92893875000003, 80.19637714285719, 90.05311800000004], ["Liquid", "Thermal generation", 9.479109818726624, 8.534858112, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Gas", "Thermal generation", 350.57120492669185, 310.73822843596065, 271.99873862329804, 261.2169089682631, 295.8868264788085, 255.2361440829762, 185.26822033659454, 148.75319150673164, 143.1048864377355, 119.54720909942948], ["Nuclear", "Thermal generation", 163.91620313701554, 160.70999999999998, 134.9964, 77.14080000000003, 25.713600000000014, 25.713600000000014, 0.0, 0.0, 0.0, 0.0], ["Thermal generation", "District heating", 8.813193136590819, 8.269492955698503, 7.471659502709447, 6.756000613190079, 6.119337745448664, 5.552597257777692, 5.047537158511643, 4.596982950286331, 4.194671446022058, 3.8351206673425144], ["Thermal generation", "Electricity grid", 371.04544619856586, 336.85740715373316, 290.9114518123367, 250.701152570865, 206.36367116405881, 152.23891002273155, 106.36028588799655, 92.12557443166789, 93.2999215860425, 85.48623993059603], ["Thermal generation", "Losses", 570.7007468362892, 527.8153497312537, 452.04433111629254, 373.48789772026345, 268.37011819566214, 179.0148215772266, 118.07666831567536, 105.21678439944601, 106.86434545626572, 98.70752644837101], ["Solid", "CHP", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Liquid", "CHP", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Gas", "CHP", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["CHP", "Electricity grid", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["CHP", "Losses", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Electricity imports", "Electricity grid", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Wind", "Electricity grid", 5.962752417600001, 15.6240801, 46.6907841, 98.009367516, 171.37126763999999, 248.76698291999998, 305.85468131999994, 331.96859532, 336.70223532, 336.70223532], ["Tidal", "Electricity grid", 0.0, 0.0050034246575342495, 0.020013698630136998, 0.050034246575342486, 0.12508561643835608, 0.12508561643835608, 0.0, 0.0, 0.0, 0.0], ["Wave", "Electricity grid", 0.0, 0.0, 0.0030020547945205484, 0.1584417808219177, 0.39610445205479383, 0.39610445205479383, 0.0, 0.0, 0.0, 0.0], ["Geothermal", "Electricity grid", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Hydro", "Electricity grid", 4.114400994, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001], ["Electricity grid", "H2 conversion", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Electricity grid", "Over generation / exports", 0.0, 0.0, 0.0, 0.0, 0.0, 5.684341886080802e-14, 5.684341886080802e-14, 0.0, 0.0, 5.684341886080802e-14], ["Electricity grid", "Losses", 26.584481639635886, 24.960529807468536, 23.93343520605538, 24.762116376776458, 26.890453469199368, 28.722115132131943, 29.765728215246977, 31.150924031992965, 32.6022311312384, 33.997483562860964], ["Gas", "H2 conversion", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["H2 conversion", "H2", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["H2 conversion", "Losses", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Solar Thermal", "Heating and cooling - homes", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["H2", "Road transport", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Pumped heat", "Heating and cooling - homes", 0.0, 0.0, 0.0, 26.531848986755456, 52.73778740506444, 78.13342600013198, 103.77013490102007, 129.14685840625523, 154.31940612927082, 179.32414788770694], ["Pumped heat", "Heating and cooling - commercial", 0.0, 0.0, 0.0, 7.041804152839384, 13.71616867969561, 20.086710008783456, 26.215049276261592, 32.16134167163053, 37.98479359421491, 43.74417166276982], ["CHP", "Heating and cooling - homes", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["CHP", "Heating and cooling - commercial", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["District heating", "Heating and cooling - homes", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["District heating", "Heating and cooling - commercial", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["District heating", "Industry", 8.813193136590819, 8.269492955698503, 7.471659502709447, 6.756000613190079, 6.119337745448664, 5.552597257777692, 5.047537158511643, 4.596982950286331, 4.194671446022058, 3.8351206673425144], ["Electricity grid", "Heating and cooling - homes", 31.008546529888466, 27.449720194668263, 21.008280329154285, 37.31117386148016, 53.43073259911739, 69.08904612073714, 85.25480236589213, 101.4480830879028, 117.6882722031892, 134.02524273150465], ["Solid", "Heating and cooling - homes", 14.25680300224757, 12.594507369196133, 9.576220840990477, 8.221524527375555, 6.818327262604992, 5.395101403233219, 4.036377117880075, 2.683258587174869, 1.3380030936699847, 0.0], ["Liquid", "Heating and cooling - homes", 12.787029496861225, 11.296104547629522, 8.588981579032696, 7.373944679192508, 6.115406926253962, 4.838905382281341, 3.6202557655213043, 2.406633990558903, 1.200064630405038, 0.0], ["Gas", "Heating and cooling - homes", 324.47780687796825, 339.9071763659198, 341.1487076393205, 292.8882399342251, 242.89994691257056, 192.19814390848254, 143.79418145992634, 95.58992158561543, 47.665778995935995, 0.0], ["Electricity grid", "Heating and cooling - commercial", 28.551697890247862, 27.67598233502796, 25.622593678781335, 26.070919424435566, 26.645959007913262, 27.349752170583066, 28.18576294225938, 29.158883159556222, 30.275450308029814, 31.54327949039369], ["Solid", "Heating and cooling - commercial", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Liquid", "Heating and cooling - commercial", 9.080594910929866, 8.909441053262125, 8.214220834308549, 6.848792699594636, 5.565221332979472, 4.352419014588807, 3.199718843817366, 2.096784703485458, 1.0335236429739016, 0.0], ["Gas", "Heating and cooling - commercial", 78.26235982624942, 76.78724669480462, 74.9428879863531, 62.49813821201373, 50.79957529629567, 39.74615702410077, 29.24067722811602, 19.188945321768852, 9.498987882353585, 0.08026608473685735], ["Electricity grid", "Lighting & appliances - homes", 86.7250002380565, 69.61613883773953, 65.95205870831911, 62.690451830509986, 59.784053022010816, 57.19069097213555, 54.989971072362366, 52.91828588368308, 51.060472781307624, 49.392015032382844], ["Gas", "Lighting & appliances - homes", 8.015505937787601, 7.401636821413865, 6.3976391649967965, 5.4167063476587005, 4.45874295936378, 3.5234283998795193, 2.6159003049656158, 1.7229272015666452, 0.8510869478464239, 0.0], ["Electricity grid", "Lighting & appliances - commercial", 72.6348790796996, 72.40051137801733, 69.40555995124195, 66.82338578202129, 64.6151830492934, 62.7467333098353, 61.187909360380345, 59.91223683079552, 58.89650672260337, 58.12043293759403], ["Gas", "Lighting & appliances - commercial", 8.985416804102144, 8.30008379511199, 7.012196838700215, 5.803244623386738, 4.66931529239573, 3.606672895273148, 2.611749908496183, 1.6811400627171766, 0.8115914643891077, 0.0], ["Electricity grid", "Industry", 122.78056381550303, 123.261073096356, 123.25238381155586, 122.06889808752447, 120.01748392107139, 116.7861646773456, 113.5453129872629, 115.02219069739814, 115.22960610648249, 114.4149025396209], ["Solid", "Industry", 54.597961583125404, 50.064089803471546, 43.292561133915676, 37.39645262628368, 32.264824276814196, 27.7776429701389, 23.89598171023473, 20.52262101660551, 17.59264873495676, 15.049318157373422], ["Liquid", "Industry", 137.88972002131388, 128.40747150183833, 116.2967136369286, 105.52037251722086, 96.31044730620191, 88.44001606523523, 81.6977672018366, 75.9089447216646, 70.92845176632763, 66.6353472860412], ["Gas", "Industry", 216.87688137738803, 190.26471986954425, 157.65236201165098, 128.91087361899508, 105.00445742229758, 85.12779171132117, 68.66664483902308, 49.89706526557941, 34.4440973010428, 21.763559707873014], ["Electricity grid", "Agriculture", 4.172844, 4.228683853807973, 4.217390401547222, 4.207040435868719, 4.19760979106593, 4.189074920393292, 4.206955385122259, 4.225686324364959, 4.245245954751176, 4.265613050852419], ["Solid", "Agriculture", 0.8345688, 0.8457367707615946, 0.8434780803094444, 0.8414080871737437, 0.839521958213186, 0.8378149840786584, 0.8413910770244519, 0.8451372648729918, 0.849049190950235, 0.8531226101704839], ["Liquid", "Agriculture", 3.4425963, 3.4886641793915776, 3.479347081276458, 3.4708083595916928, 3.4630280776293922, 3.455986809324466, 3.470738192725864, 3.486191217601091, 3.5023279126697195, 3.519130766953246], ["Gas", "Agriculture", 1.9821009, 2.0086248305587873, 2.0032604407349304, 1.9983442070376414, 1.9938646507563167, 1.9898105871868137, 1.9983038079330733, 2.0072010040733557, 2.0164918285068083, 2.026166199154899], ["Electricity grid", "Road transport", 0.0, 0.0, 1.4711367001904314, 2.317256614768487, 20.750417218384424, 35.9740222491628, 39.332665203581016, 42.00965964251307, 46.19398744991427, 50.00244884134966], ["Liquid", "Road transport", 490.85404977847907, 451.2447936134608, 407.5260610503296, 351.56682522894465, 237.18491210811123, 138.48343290997542, 111.98457672626404, 87.33080170729596, 61.630327167766325, 39.8384230610764], ["Electricity grid", "Rail transport", 8.681592457134547, 8.26449747617325, 8.268924319996922, 8.76125694025507, 9.194407435119663, 9.739088008207021, 10.279778063415291, 10.762378543700288, 11.223830366668142, 11.657808334206777], ["Liquid", "Rail transport", 7.1708543458911045, 9.843867673193465, 10.113814462663617, 9.159080806148134, 8.252503029650093, 6.650882465015867, 4.979140025056566, 3.2676661854608096, 1.5950753356083385, 0.0], ["Liquid", "Domestic aviation", 9.019834608709552, 9.4371304209735, 10.043448539389448, 10.86602897688554, 11.616843320399934, 12.179196308214529, 12.682054831349237, 13.017769004412454, 13.303419433940144, 13.546832091915194], ["Liquid", "National navigation", 18.817339999999998, 27.144937170003814, 27.32305556984198, 27.858606532706467, 28.582641909901167, 29.635401755478146, 30.699187307229483, 31.774954722510824, 32.86371234516199, 33.96652500925593], ["Liquid", "International aviation", 152.8, 125.0255611993506, 140.43447064822013, 152.08499508893127, 156.3594388399908, 156.88646088388506, 157.09710975651626, 143.73016730483914, 139.43914213433317, 130.75289868996683], ["Liquid", "International shipping", 54.1581570872572, 57.28499215184298, 52.37642070782899, 42.384644676983896, 39.88547771236235, 37.53367155646424, 35.32053723081991, 33.23789809363531, 31.278059630386895, 29.43378102568326], ["Electricity grid", "Geosequestration", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Gas", "Losses", 11.146951526623873, 10.562065783600955, 9.544054804799737, 8.210264086395947, 7.550256993919524, 6.130108090419063, 4.442728141987731, 3.1252496273893113, 2.2133502606565316, 1.1361265165724836]])
    assert_equal(workbook.output_ghg_by_ipcc_sector, [["Mt CO2e", 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Fuel Combustion", 493.8353686614453, 443.41752017970117, 388.1546047028439, 303.17980677955114, 217.3856130776453, 175.94893193476517, 147.5808320472251, 125.54760220538799, 102.00114195754469], ["Industrial Processes", 25.576005299134735, 22.313355940083635, 19.652815063492223, 17.463814907050935, 15.645846734525291, 14.121384291477694, 12.83048772657884, 11.72668754301496, 10.773843695924194], ["Solvent and Other Product Use", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Agriculture", 42.00052516915963, 38.75403774889721, 35.68224166350021, 34.8031900419121, 33.954355087774815, 33.134514910165734, 32.34249985752374, 31.57719024649625, 30.837514190025274], ["LULUCF", 2.5275311584448135, 4.956913883948951, 7.262741065125612, 8.897927142800105, 8.614575371214668, 7.6465012608286695, 5.0406155355537665, 2.49820257160225, 0.679952656905922], ["Waste", 15.21267066552306, 12.969805414772946, 10.72882425342694, 8.62229908940291, 6.762914714481023, 5.723830856814635, 4.788626675722327, 4.000303181877479, 3.277950237496105], ["Other", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Int'l Aviation & Shipping", 46.454417424008525, 49.130000794276135, 49.55266525125296, 50.005022217782916, 49.540050326197296, 49.029798487179626, 45.0931020153483, 43.50032407043358, 40.817049526157064], ["Bioenergy credit", -16.414615806538304, -33.905442277769126, -57.98146312042345, -82.82035863617517, -58.797173942011725, -58.661648049450314, -64.6893062648151, -70.38099815982387, -76.03417775054055], ["Carbon capture", 0.0, -2.8350150827586207, -6.981413926369411, -8.265471904050598, -10.971918291248226, -14.611526859731743, -18.829269322045324, -23.342875820059156, -28.875809329406156], ["Total", 609.1919025711777, 534.8011766011523, 446.07101495284905, 331.8862296382744, 262.1342630785784, 212.33178683204946, 164.15758827109164, 125.1264358389295, 83.47746518410655], ["Targets", 603.6, 556.4, 508.8, 390.0, nil, nil, nil, nil, 159.917234]])
    assert_equal(workbook.output_ghg_percentage_reduction, 0.8926508976630851)
    assert_equal(workbook.output_heating_mix, [["2050 Split of heating technology", "Residential", "Commercial"], ["Gas boiler (old)", 0.0, 0.0], ["Gas boiler (new)", 0.0, 0.001], ["Resistive heating", 0.1, 0.1], ["Oil-fired boiler", 0.0, 0.0], ["Solid-fuel boiler", 0.0, 0.0], ["Stirling engine micro-CHP", 0.0, 0.0], ["Fuel-cell micro-CHP", 0.0, 0.0], ["Air-source heat pump", 0.6, 0.6], ["Ground-source heat pump", 0.3, 0.3], ["Geothermal electricity", 0.0, 0.0], ["Community scale gas CHP with local district heating", 0.0, 0.0], ["Community scale solid-fuel CHP with local district heating", 0.0, 0.0], ["Long distance district heating from large power stations", 0.0, 0.0], ["Total", 1.0, 1.0]])
    assert_equal(workbook.output_imports_proportion, [["Vector", 2007.0, 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Uranium", 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0], ["Electricity", 3.2666686061216747e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Bioenergy", 0.08000841196404224, 0.3092892753023524, 0.37072292870374696, 0.35452967805404473, 0.36857191814340523, 0.24680585260431168, 0.2667388136181918, 0.28017499920289374, 0.2892089892754773, 0.2965270409772066], ["Coal", 0.7354674748976808, 0.6919767090206314, 0.5996773880101762, 0.37687880317117123, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Oil", 0.0, 0.03405722158508837, 0.14697477509045484, 0.2562410412737338, 0.27358785193713864, 0.26232613006564093, 0.3418459680306817, 0.37621308815801513, 0.4014193210104421, 0.39183777998213215], ["Gas", 0.25279632480004327, 0.3033595627909587, 0.40799136103677686, 0.46831284956484365, 0.5526271921252814, 0.5736353287143658, 0.5447838811361674, 0.4992733746692201, 0.4529169274420968, 0.17530235627605772], ["Total", 0.29532565336511213, 0.3213373090008919, 0.3708613219715558, 0.3647970326421161, 0.3657262544861837, 0.32851276800681706, 0.2948683458510496, 0.26187828025784704, 0.23745982527241588, 0.18666634482461994]])
    assert_equal(workbook.output_imports_quantity, [["Vector", 2007.0, 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["Uranium", 163.91620313701554, 160.70999999999998, 134.9964, 77.14080000000003, 25.713600000000014, 25.713600000000014, 0.0, 0.0, 0.0, 0.0], ["Electricity", 5.684341886080802e-14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Bioenergy", 4.39614, 23.256483720930234, 55.349423255813946, 87.44236279069767, 119.5353023255814, 74.6998046511628, 91.02485348837209, 107.34990232558138, 123.67495116279069, 140.0], ["Coal", 345.85158236078604, 287.39573589887635, 191.63725942638484, 77.37516479146888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Oil", 0.0, 28.296244946608567, 111.44749419386642, 172.87714192578505, 146.23550561838766, 106.84010316898906, 120.7474835271164, 108.49028278981493, 93.34408504533644, 69.39307324825394], ["Gas", 247.31424585054333, 281.20874542181105, 341.74813785496434, 337.4546879302331, 366.1982377170308, 308.62157833013873, 212.4204151265127, 136.94474878018232, 87.98141927589663, 17.47981028533563], ["Total", 761.478171348345, 780.8672099882263, 835.1787147310295, 752.2901574381847, 657.6826456609999, 515.8750861502906, 424.19275214200115, 352.78493389557866, 305.00045548402375, 226.87288353358957]])
    assert_equal(workbook.output_primaryenergysupply, [["Vector", 2010.0, 2015.0, 2020.0, 2025.0, 2030.0, 2035.0, 2040.0, 2045.0, 2050.0], ["UK Gas", 645.772895884115, 495.88758312335, 383.12064593856, 296.451452589944, 229.388482908284, 177.496435356475, 137.343358153041, 106.273672431058, 82.2325418852722], ["Imported Gas", 281.20874542181105, 341.74813785496434, 337.4546879302331, 366.1982377170308, 308.62157833013873, 212.4204151265127, 136.94474878018232, 87.98141927589663, 17.47981028533563], ["UK Oil", 802.547952837212, 646.828843533316, 501.788950072749, 388.274724214433, 300.439580110198, 232.474419959775, 179.884274621243, 139.191022657933, 107.703360003839], ["Imported Oil", 28.296244946608567, 111.44749419386642, 172.87714192578505, 146.23550561838766, 106.84010316898906, 120.7474835271164, 108.49028278981493, 93.34408504533644, 69.39307324825394], ["UK Coal", 127.93, 127.93, 127.93, 5.481869838166972, 0.0, 0.0, 0.0, 0.0, 0.0], ["Imported Coal", 287.39573589887635, 191.63725942638484, 77.37516479146888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["UK Bioenergy", 51.9368242209483, 93.95189848693941, 159.20091759884394, 204.7848545862976, 227.9664565534461, 245.07101345088014, 268.6796131249231, 291.219633524521, 313.5824514617233], ["Imported Bioenergy", 23.256483720930234, 55.349423255813946, 87.44236279069767, 119.5353023255814, 13.597250687399011, 0.0, 0.0, 0.0, 0.0], ["Nuclear fission", 160.70999999999998, 134.9964, 77.14080000000003, 25.713600000000014, 25.713600000000014, 0.0, 0.0, 0.0, 0.0], ["Wind", 15.6240801, 46.6907841, 98.009367516, 171.37126763999999, 248.76698291999998, 305.85468131999994, 331.96859532, 336.70223532, 336.70223532], ["Solar", 0.04091830086816001, 0.17678344108122454, 0.7637752393779744, 1.9404426406237414, 4.929876549307031, 9.204190387526294, 17.184430450239162, 32.08371811814199, 59.90102327016994], ["Tidal", 0.0050034246575342495, 0.020013698630136998, 0.050034246575342486, 0.12508561643835608, 0.12508561643835608, 0.0, 0.0, 0.0, 0.0], ["Wave", 0.0, 0.0030020547945205484, 0.1584417808219177, 0.39610445205479383, 0.39610445205479383, 0.0, 0.0, 0.0, 0.0], ["Geothermal", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Hydro", 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001, 5.329728000000001], ["Electricity imports", 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ["Environmental heat", 0.0, 0.0, 33.57365313959484, 66.45395608476005, 98.22013600891543, 129.98518417728167, 161.30820007788577, 192.30419972348574, 223.06831955047676], ["Total used in UK", 2430.0546127560274, 2251.9973511691405, 2062.215670970708, 1798.2921313237184, 1570.3349653051705, 1438.5835513055672, 1347.1332313173293, 1284.4297140963727, 1215.3925430250706]])
    assert_equal(workbook.output_shannonweinerindex, [["Shannon-Weiner Index", 1.641184526640037, 1.7871576584571227, 2.0090584268551157, 2.183867322958779, 2.1924287971526852, 2.224417751535101, 2.243476183927484, 2.2661668453889257, 2.2653956163883158, 2.2026033591436716]])
    assert_equal(workbook.output_version, "Version 3.6.0")

  end
end
